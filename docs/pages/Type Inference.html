
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Type Inference Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Type Compatibility.html" />
    
    
    <link rel="prev" href="Enums.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Basic Types.html">
            
                <a href="Basic Types.html">
            
                    
                    Basic Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Variable Declarations.html">
            
                <a href="Variable Declarations.html">
            
                    
                    Variable Declarations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Interfaces.html">
            
                <a href="Interfaces.html">
            
                    
                    Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Classes.html">
            
                <a href="Classes.html">
            
                    
                    Classes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="Functions.html">
            
                <a href="Functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="Generics.html">
            
                <a href="Generics.html">
            
                    
                    Generics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="Enums.html">
            
                <a href="Enums.html">
            
                    
                    Enums
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9" data-path="Type Inference.html">
            
                <a href="Type Inference.html">
            
                    
                    Type Inference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="Type Compatibility.html">
            
                <a href="Type Compatibility.html">
            
                    
                    Type Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="Advanced Types.html">
            
                <a href="Advanced Types.html">
            
                    
                    Advanced Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="Symbols.html">
            
                <a href="Symbols.html">
            
                    
                    Symbols
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="Iterators and Generators.html">
            
                <a href="Iterators and Generators.html">
            
                    
                    Iterators and Generators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="Modules.html">
            
                <a href="Modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="Namespaces.html">
            
                <a href="Namespaces.html">
            
                    
                    Namespaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="Namespaces and Modules.html">
            
                <a href="Namespaces and Modules.html">
            
                    
                    Namespaces and Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="Module Resolution.html">
            
                <a href="Module Resolution.html">
            
                    
                    Module Resolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="Declaration Merging.html">
            
                <a href="Declaration Merging.html">
            
                    
                    Declaration Merging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="JSX.html">
            
                <a href="JSX.html">
            
                    
                    JSX
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="Decorators.html">
            
                <a href="Decorators.html">
            
                    
                    Decorators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="Mixins.html">
            
                <a href="Mixins.html">
            
                    
                    Mixins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="Triple-Slash Directives.html">
            
                <a href="Triple-Slash Directives.html">
            
                    
                    Triple-Slash Directives
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="Type Checking JavaScript Files.html">
            
                <a href="Type Checking JavaScript Files.html">
            
                    
                    Type Checking JavaScript Files
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Type Inference</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="introduction">Introduction</h1>
<p>In this section, we will cover type inference in TypeScript. Namely, we&apos;ll discuss where and how types are inferred.</p>
<h1 id="basics">Basics</h1>
<p>In TypeScript, there are several places where type inference is used to provide type information when there is no explicit type annotation. For example, in this code</p>
<pre><code class="lang-ts"><span class="hljs-keyword">let</span> x = <span class="hljs-number">3</span>;
</code></pre>
<p>The type of the <code>x</code> variable is inferred to be <code>number</code>.
This kind of inference takes place when initializing variables and members, setting parameter default values, and determining function return types.</p>
<p>In most cases, type inference is straightforward.
In the following sections, we&apos;ll explore some of the nuances in how types are inferred.</p>
<h1 id="best-common-type">Best common type</h1>
<p>When a type inference is made from several expressions, the types of those expressions are used to calculate a &quot;best common type&quot;. For example,</p>
<pre><code class="lang-ts"><span class="hljs-keyword">let</span> x = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">null</span>];
</code></pre>
<p>To infer the type of <code>x</code> in the example above, we must consider the type of each array element.
Here we are given two choices for the type of the array: <code>number</code> and <code>null</code>.
The best common type algorithm considers each candidate type, and picks the type that is compatible with all the other candidates.</p>
<p>Because the best common type has to be chosen from the provided candidate types, there are some cases where types share a common structure, but no one type is the super type of all candidate types. For example:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">let</span> zoo = [<span class="hljs-keyword">new</span> Rhino(), <span class="hljs-keyword">new</span> Elephant(), <span class="hljs-keyword">new</span> Snake()];
</code></pre>
<p>Ideally, we may want <code>zoo</code> to be inferred as an <code>Animal[]</code>, but because there is no object that is strictly of type <code>Animal</code> in the array, we make no inference about the array element type.
To correct this, instead explicitly provide the type when no one type is a super type of all other candidates:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">let</span> zoo: Animal[] = [<span class="hljs-keyword">new</span> Rhino(), <span class="hljs-keyword">new</span> Elephant(), <span class="hljs-keyword">new</span> Snake()];
</code></pre>
<p>When no best common type is found, the resulting inference is the union array type, <code>(Rhino | Elephant | Snake)[]</code>.</p>
<h1 id="contextual-type">Contextual Type</h1>
<p>Type inference also works in &quot;the other direction&quot; in some cases in TypeScript.
This is known as &quot;contextual typing&quot;. Contextual typing occurs when the type of an expression is implied by its location. For example:</p>
<pre><code class="lang-ts"><span class="hljs-built_in">window</span>.onmousedown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mouseEvent</span>) </span>{
    <span class="hljs-built_in">console</span>.log(mouseEvent.button);  <span class="hljs-comment">//&lt;- Error</span>
};
</code></pre>
<p>For the code above to give the type error, the TypeScript type checker used the type of the <code>Window.onmousedown</code> function to infer the type of the function expression on the right hand side of the assignment.
When it did so, it was able to infer the type of the <code>mouseEvent</code> parameter.
If this function expression were not in a contextually typed position, the <code>mouseEvent</code> parameter would have type <code>any</code>, and no error would have been issued.</p>
<p>If the contextually typed expression contains explicit type information, the contextual type is ignored.
Had we written the above example:</p>
<pre><code class="lang-ts"><span class="hljs-built_in">window</span>.onmousedown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mouseEvent: <span class="hljs-built_in">any</span></span>) </span>{
    <span class="hljs-built_in">console</span>.log(mouseEvent.button);  <span class="hljs-comment">//&lt;- Now, no error is given</span>
};
</code></pre>
<p>The function expression with an explicit type annotation on the parameter will override the contextual type.
Once it does so, no error is given as no contextual type applies.</p>
<p>Contextual typing applies in many cases.
Common cases include arguments to function calls, right hand sides of assignments, type assertions, members of object and array literals, and return statements.
The contextual type also acts as a candidate type in best common type. For example:</p>
<pre><code class="lang-ts">function createZoo(): Animal[] {
    return [new Rhino(), new Elephant(), new Snake()];
}
</code></pre>
<p>In this example, best common type has a set of four candidates: <code>Animal</code>, <code>Rhino</code>, <code>Elephant</code>, and <code>Snake</code>.
Of these, <code>Animal</code> can be chosen by the best common type algorithm.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Enums.html" class="navigation navigation-prev " aria-label="Previous page: Enums">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Type Compatibility.html" class="navigation navigation-next " aria-label="Next page: Type Compatibility">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Type Inference","level":"1.9","depth":1,"next":{"title":"Type Compatibility","level":"1.10","depth":1,"path":"pages/Type Compatibility.md","ref":"./pages/Type Compatibility.md","articles":[]},"previous":{"title":"Enums","level":"1.8","depth":1,"path":"pages/Enums.md","ref":"./pages/Enums.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"pages/Type Inference.md","mtime":"2018-07-01T10:24:27.721Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-07-02T14:10:17.144Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

